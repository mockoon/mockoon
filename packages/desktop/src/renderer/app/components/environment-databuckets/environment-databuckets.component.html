<div class="d-flex h-100">
  <app-databuckets-menu class="h-100"></app-databuckets-menu>

  <div class="d-flex flex-column flex-fill mh0 p-2">
    <ng-container
      *ngIf="
        activeDatabucket$ | async as activeDatabucket;
        else noActiveDatabucket
      "
    >
      <ng-container [formGroup]="activeDatabucketForm">
        <!-- Name -->
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            placeholder="Databucket name"
            appValidPath
            formControlName="name"
            [appFocusOnEvent]="focusableInputs.DATABUCKET_NAME"
          />
        </div>

        <!-- Documentation -->
        <div class="input-group mt-2">
          <input
            type="text"
            class="form-control"
            placeholder="Add notes or documentation"
            formControlName="documentation"
          />
        </div>

        <!-- Editor -->
        <div
          class="flex-fill mt-2"
          *ngIf="bodyEditorConfig$ | async as bodyEditorConfig"
        >
          <app-editor
            class="h-100"
            [options]="bodyEditorConfig?.options"
            mode="json"
            [theme]="bodyEditorConfig?.theme"
            [uuid]="activeDatabucket.uuid"
            formControlName="value"
          >
          </app-editor>
        </div>
        <div
          class="d-flex justify-content-between align-items-center environment-databuckets-footer pt-1 mt-3"
        >
          <div [ngbTooltip]="bucketIdTooltip">
            <small> ID: {{ activeDatabucket.id }}</small>
          </div>
          <ng-template #bucketIdTooltip
            >Data ID (can be used in within helpers)</ng-template
          >

          <button
            type="button"
            class="btn btn-link btn-icon btn-xs text-primary ml-auto"
            (click)="openWikiLink('templating')"
          >
            Open data buckets documentation
          </button>
        </div>
      </ng-container>
    </ng-container>
  </div>
</div>

<ng-template #noActiveDatabucket>
  <p class="message mt-4">No databucket defined</p>
</ng-template>
